# Debugging

## Debuggers

As a personal choice, we tend **not to use** `debuggers` *beyond getting a stack trace or the value of a variable or two.*

一般不要去用 IDE 中的 debugger，因为：

- 容易 get lost in details of complicated data structures and control flow
  - stepping through a program less productive than thinking harder and adding output statements and self-checking code at critical places.
  - 一步步地点击按钮去 step into，还不如仔细思考，在关键处使用打印语句来检查
    - debugging statements **stay** with the program

## Good Clues, Easy Bugs

忘记 initialize a `local variable` 是比较常见的错误。

`local variable` 不自动初始化的原因是：就是怕你忘记更改值，结果使用了默认值而造成严重错误

- **Look for familiar patterns.** 
  - Ask yourself whether this is a familiar pattern.
- **Examine the most recent change.**
  - What was the last change?
- **Don't make the same mistake twice.**
  - After you fix a bug, ask whether you might have made the same mistake somewhere else.
- **Debug it now, not later.**
- **Get a stack trace.** 
  - Although `debuggers` can probe running programs, one of their most common uses is to examine **the state of a program** after death.
- **Read before typing.** 
  - One effective but under-appreciated debugging technique is to read the code very carefully and think about it for a while without making changes.
  - 甚至可以将关键代码打印出来，仔细思考后再去修改；或者先抛开一会，休息后再重新来过
-  **Explain your code to someone else.** 
  - 小黄鸭解释法，的确有效！

## No Clues, Hard Bugs

- Make the bug reproducible.
- Divide and conquer.
  - 设法找出最关键的部分，用最小的测试可以重现出错误
  - 把一个大错误分解，找出每部分小错误的测试代码
  - 可以使用二分的思想来寻找正确的测试输入
- Study the numerology of failures.
  - 看出错的地方是否呈现出统计规律，而不是随机出现
- Display output to localize your search. 
  - If you don't understand what the program is doing, `adding statements to display more information` can be the easiest, most cost-effective way to find out. Put them in to verify your understanding or refine your ideas of what's wrong.
  - If output is potentially voluminous, it might be sufficient to `print single-letter outputs` like A, B, ..., as a compact display of where the program went.
- Write self-checking code.
  - If more information is needed, you can write your own check function to `test` a condition, `print` relevant variables and `abort` the program
- Write a log file.
- Draw a picture.
  - 利用图形来理解数据结构
  - 利用图形来形象化统计信息
- Use tools.
  - Write `trivial programs` to test hypotheses or confirm your understanding of how something works.
- Keep records.
  - 把解决错误的过程、经验教训记录下来，防止遗忘
  - 记录每种试验的情况，避免忘记了，防止重复试验或者以为试验了但实际没做