---
title: 风格
toc: true
date: 2017-10-8 23:28:59
tags: [代码规范]
---

## 风格

使代码更容易读——也更容易修改

一致性是很重要的东西

这本书用了真实的例子来展示要怎样修改

### name

Much information comes from `context` and `scope`; the **broader** the scope of a variable, the **more information** should be conveyed by its name.

* Use descriptive names for `globals`, short names for `locals`.
  * i and j for loop indices, p and q for pointers, and s and t for strings
* Be **consistent**. Give related things related names that show their relationship and highlight their difference.
  * 如类成员中不必再次重复提及类，那是多余的，因为有 context 说明了它们的关系
* 函数名：动词 + 名词
  * 但布尔型的函数应该用：`isPhone()` 这样来反映返回的布尔值
* Be **accurate**. A name not only labels, it conveys information to the reader. A misleading name can result in mystifying bugs. 
  * 正确的名字，实现却是错误的
  * 名字和实现是相反的

### Expressions and Statements

现在有了  IDE，下面的结构问题倒不用那么费心了

* 逻辑判断中，使用否定形式较难阅读，应该改写回用肯定形式
  * `if ((block_id <= actblks) || (blockkid < unblocks ))`
* 使用括号
  * 排除二义性
  * 用作分隔符，使得结构更清晰
* 括号内，优先级高的运算符可以和运算对象连在一起，使得结构更清晰
  * `leap_year = ((y%4 == 0) && (y%100 != 0)) || (y%400 == 0)`
* 分解复杂的表达式
  * 使得人可以接受，而不是一段对的式子，但是人却很难看懂

> Programmers' endless creative energy is sometimes used to write the most concise code possible, or to find clever ways to achieve a result. Sometimes these skills are misapplied, though, since the goal is to `write clear code`, not clever code.

`?:` 适用于短的表达式，但不应该一概用去替换 `if` 语句

清晰性不等于简短，而是在于是否容易理解

小心副作用：如 `++` 这类运算符，还有 `I/O 操作` 

### Consistency and Idioms

* Use a consistent `indentation` and `brace` style.

选定一种推荐的风格，保持一致性更重要，不要浪费时间去争论

> Programmers have always argued about the layout of programs, but the specific style is much less important than its consistent application. Pick one style, preferably ours, use it consistently, and don't waste time arguing.

* Use `idioms` for consistency.
  * 循环中元素初始化
* Use `else-ifs` for multi-way decisions.

``` c
if (condition_1)
	statement_1
else if (condition_2)
	statement_2
...
else if (condition_n)
	statement_n
else default_statement
```

最后一个 `else` 处理默认的情况，或者上面没有处理的情况。如果没有默认情况，也可以不用最后一个 `else`

还可以这样用：利用他来给出异常信息，以捕捉“不可能发生”的情况

可以使用这种结构来修正拙劣的`if 嵌套语句`

> The rule is to follow **each decision** as **closely** as possible by its **associated action**. Or, to put it another way, each time you make a test, do something.

## 数字

常数

* C ++：`const`
* Java：`final`
* C：`enum`

表示清楚每种 `0` 的类型，仅把 `0` 作为整数常量

```c
str = NULL;
name[i] = '\0';
x = 0.0;
```

不过需要注意的是，在 C++ 里人们已经接受使用 `0` （而不是 `NULL` ）来表示空指针了

## 注释

> The best comments aid the understanding of a program by **briefly pointing out salient details** or by **providing a lager-scale view** of the proceedings.

注释里不要说显而易见的东西，不要重复代码能体现出来的说明

> Comments should add something that is not immediately evident from the code, or `collect` into one place information that is spread through the source.

注释里应该：提些不能一下子从代码看出来的信息，或者将各处散落的信息集合起来

和代码的一致性：当你改变代码时，要注意注释是否仍是准确的

Don't comment bad code, rewrite it.

> Comments are meant to help a reader understand pans of the program that are not readily understood from the code itself. As much as possible, **write code that is easy to understand**; the better you do this, the fewer comments you need. **Good code needs fewer comments than bad code.**

注释只是工具，用来帮助理解代码，如果代码写得好，需要的注释其实会越少

